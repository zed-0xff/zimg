# frozen_string_literal: true

ASCII_QR = <<~EOQR
  ...................................
  .#######.##.....##.#.##....#######.
  .#.....#.......##.#.##.....#.....#.
  .#.###.#.#..#####..#.#..##.#.###.#.
  .#.###.#.##.#....#.####.##.#.###.#.
  .#.###.#.####.#....#.####..#.###.#.
  .#.....#..#..#.#..#####....#.....#.
  .#######.#.#.#.#.#.#.#.#.#.#######.
  ..........#.#.##.....##.##.........
  .####..#.#....##.#.##....##..###.#.
  ..#.##...##.....##.#.##.#.###...##.
  .#.###.##......##.#.##..##.#.###.#.
  ....###.#...#####..#.#...##.#...#..
  .##.##.#..#.#....#.####..##.##.....
  ...#..#.##.##.#....#.###.##....##..
  .#.######.##.#.#..#####..#######...
  .#.####..###.##.#.##....#...##.#...
  ...##.##..###.....##.#.##.########.
  .....#..###..##.....##.#########.#.
  .####.#####.##.....##.#...#...#.#..
  ..##.#..#..#.#..#####..#.#..##...#.
  ...######.#####.#....#.##......#...
  ..###.....#..####.#....###.#...###.
  .###..####.####..#.#..#######...##.
  .#.#.##.##.#.....##.#.##.######.#..
  ..#.#######..#.##.....##.#####...#.
  .........#.###.#.##.....##...#.#...
  .#######....#.#.##.....###.#.#.....
  .#.....#..###..#.#..######...###.#.
  .#.###.#.....#.####.#...########...
  .#.###.#.###...#.####.#.#.#........
  .#.###.#.###..#####..#.##..#..#....
  .#.....#.####.##.....##.###......#.
  .#######.#.#..##.#.##...#.##...#...
  ...................................
EOQR

RSpec.describe "ZIMG png2ascii" do
  it "has QR examples" do
    expect(Dir[File.join(PNG_SAMPLES_DIR, "qr_*.png")]).not_to be_empty
  end

  Dir[File.join(PNG_SAMPLES_DIR, "qr_*.png")].each do |fname|
    describe fname do
      it "generates a nice ascii img" do
        expect(ZIMG.load(fname).to_ascii("#.").strip).to eq ASCII_QR.strip
      end
    end
  end
end
